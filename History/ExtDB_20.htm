<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=windows-1251"/>
	<title>Изменения в модуле ExtDB.dll</title>
	<meta name="generator" content="LibreOffice 5.4.7.2 (Windows)"/>
	<meta name="created" content="00:00:00"/>
	<meta name="changed" content="2023-06-04T19:44:48.571000000"/>
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<style type="text/css">
		@page { margin: 2cm }
		td p { margin-bottom: 0.25cm; background: transparent; line-height: 120%; orphans: 0; widows: 0 }
		h1 { margin-bottom: 0.21cm; background: transparent }
		h1.western { font-family: "Liberation Serif", serif }
		h1.cjk { font-family: "SimSun"; font-size: 24pt }
		h1.ctl { font-family: "Mangal"; font-size: 24pt }
		p { margin-bottom: 0.25cm; background: transparent; line-height: 120% }
		a:link { so-language: zxx }
		a:visited { color: #800080 }
	</style>
</head>
<body lang="ru-RU" vlink="#800080" dir="ltr">
<h1 class="western">История изменений <br/>
Модуль <span lang="en-US">ExtDB</span>.<span lang="en-US">dll</span>
(Доступ к базам данных)</h1>
<p>Модуль входит в комплект библиотек <span lang="en-US">FreeLibSet</span>,
и является свободным программным обеспечением (Free Software)</p>
<h1 class="western">Версия <span lang="en-US">2</span>.<span lang="en-US">0</span></h1>
<p>Полный номер версии файла, который можно узнать, посмотрев
свойства файла или в меню &laquo;О программе&raquo;, состоит из
четырех чисел и имеет вид &laquo;<span lang="en-US">2</span>.<span lang="en-US">0</span>.0.<span lang="en-US">X</span>&raquo;.
В таблице указано только последнее число &laquo;<span lang="en-US">X</span>&raquo;</p>
<table width="100%" cellpadding="3" cellspacing="0">
	<col width="25*">
	<col width="35*">
	<col width="196*">
	<tr valign="top">
		<td width="10%" style="border: 1.00pt solid #000000; padding: 0.05cm">
			<p align="center">Версия</p>
		</td>
		<td width="14%" style="border-top: 1.00pt solid #000000; border-bottom: 1.00pt solid #000000; border-left: none; border-right: 1.00pt solid #000000; padding-top: 0.05cm; padding-bottom: 0.05cm; padding-left: 0cm; padding-right: 0.05cm">
			<p align="center">Дата</p>
		</td>
		<td width="77%" style="border-top: 1.00pt solid #000000; border-bottom: 1.00pt solid #000000; border-left: none; border-right: 1.00pt solid #000000; padding-top: 0.05cm; padding-bottom: 0.05cm; padding-left: 0cm; padding-right: 0.05cm">
			<p align="center">Что сделано</p>
		</td>
	</tr>
	<tr valign="top">
		<td width="10%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: 1.00pt solid #000000; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0.05cm; padding-right: 0.05cm" sdval="345" sdnum="1049;">
			<p lang="en-US" align="center">345</p>
		</td>
		<td width="14%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: none; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0cm; padding-right: 0.05cm">
			<p lang="en-US" align="center">21.04.2023-04.06.2023</p>
		</td>
		<td width="77%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: none; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0cm; padding-right: 0.05cm">
			<p><span lang="en-US">1. </span><span lang="ru-RU">Изменения в
			конструкторе DBxColumns</span> <span lang="en-US">(<a href="ExtDB_11.htm#v001p2">v.1
			</a></span><a href="ExtDB_11.htm#v001p2"><span lang="ru-RU">п.2</span></a><span lang="en-US">)</span></p>
			<p><span lang="en-US">2. </span><span lang="ru-RU">Внутренние
			изменения в методах DBxColumns, </span><span lang="en-US">DBxColumnList()</span></p>
			<p><span lang="en-US">3. </span><span lang="ru-RU">Внутренний
			класс </span><span lang="en-US">DBxTableColumnList.TableCollection
			</span><span lang="ru-RU">не был помечен </span><span lang="en-US">[Seializable]</span></p>
			<p><span lang="ru-RU">4</span><span lang="en-US">. </span><span lang="ru-RU">Перегрузка
			</span><span lang="en-US">DBxTableStruct.Clone()</span> <span lang="ru-RU">(</span><a href="ExtDB_11.htm#v001p1"><span lang="en-US">v.1
			</span><span lang="ru-RU">п.1</span></a><span lang="ru-RU">) с
			именем таблицы.</span></p>
			<p><span lang="ru-RU">5</span><span lang="en-US">. </span><span lang="ru-RU">Убрана
			перегрузка </span><span lang="en-US">DBxColumnStructList.AddBoolean()
			(<a href="ExtDB_11.htm#v001p9">v.1 </a></span><a href="ExtDB_11.htm#v001p9"><span lang="ru-RU">п.9</span></a><span lang="en-US">)
			</span><span lang="ru-RU">с тремя аргументами. Перегрузка с 2
			аргументами, вместо</span> <span lang="en-US">Nullable=true
			</span><span lang="ru-RU">устанавливает для логического поля
			</span><span lang="en-US">DefaultValue=false </span><span lang="ru-RU">(</span><a href="ExtDB_11.htm#v052p1"><span lang="en-US">v.52
			</span><span lang="ru-RU">п.1</span></a><span lang="ru-RU">)</span><span lang="en-US">.</span></p>
			<p><span lang="ru-RU">6</span><span lang="en-US">.</span>
			Изменения в <span lang="en-US">DBxExpression (<a href="ExtDB_11.htm#v045p1">v.45
			</a></span><a href="ExtDB_11.htm#v045p1"><span lang="ru-RU">п.1</span></a><span lang="en-US">):</span></p>
			<p lang="en-US">- В методе GetValue() убран аргумент
			nullAsDefaultValue</p>
			<p><span lang="en-US">- </span><span lang="ru-RU">Новый метод
			</span><span lang="en-US">GetAllExpressions()</span></p>
			<p><span lang="ru-RU">7</span><span lang="en-US">.</span>
			<span lang="en-US">Изменения в DBxFunction</span> <span lang="en-US">(<a href="ExtDB_11.htm#v045p1">v.45
			</a></span><a href="ExtDB_11.htm#v045p1"><span lang="ru-RU">п.1</span></a><span lang="en-US">)</span></p>
			<p lang="en-US">- Убраны неподдерживаемые неагрегатные функции
			DBxFunctionKind.Min и Max</p>
			<p lang="en-US">- <span lang="ru-RU">Добавлены операторы сравнения
			(=, &lt;, &lt;</span>=, &gt;, &gt;= <span lang="ru-RU">и &lt;&gt;)</span></p>
			<p lang="en-US"><span lang="ru-RU">- Добавлена функция </span>IIf</p>
			<p lang="en-US">- GetValue() для функции DBxFunctionKind.Substring
			реализовано через DataTools.Substring()</p>
			<p lang="en-US">- GetValue() возвращает null, если хотя бы один из
			аргументов равен null</p>
			<p lang="en-US">- GetConst() возвращает константное выражение,
			если все аргументы являются константными.</p>
			<p>8. Переименование <span lang="ru-RU">для исправления
			грамматической ошибки &laquo;</span><span lang="en-US">agregate</span><span lang="ru-RU">&raquo;
			-&gt; &laquo;</span><span lang="en-US">aggregate</span><span lang="ru-RU">&raquo;
			</span><span lang="en-US">(DBxAggregateFunction </span><span lang="ru-RU">и
			связанные классы методы)</span></p>
			<p><span lang="ru-RU">9</span>. Функция <span lang="en-US">DBxTools.Convert().
			</span>Используется методами <span lang="en-US">CompareFilter,
			ValuesFilter.TestFilter().</span></p>
			<p><span lang="en-US">1</span><span lang="ru-RU">0. Определено,
			что для </span><span lang="en-US">DBxColumnType.Time </span><span lang="ru-RU">основным
			типом является </span><span lang="en-US">TimeSpan, </span><span lang="ru-RU">а
			не </span><span lang="en-US">DateTime. </span><span lang="ru-RU">Изменения
			в методах </span><span lang="en-US">DBxTools.</span></p>
			<p><span lang="ru-RU">11</span><span lang="en-US">.
			DBxFilter.GetAllFilters() (<a href="ExtDB_11.htm#v048p5">v.48 </a></span><a href="ExtDB_11.htm#v048p5"><span lang="ru-RU">п.5</span></a><span lang="en-US">)
			</span><span lang="ru-RU">принимает аргумент </span><span lang="en-US">IList&lt;DBxFilter&gt;</span><span lang="ru-RU">,
			а не </span><span lang="en-US">List&lt;&gt;</span></p>
			<p><span lang="ru-RU">12</span><span lang="en-US">.</span>
			<span lang="en-US">Изменения в CompareFilter</span> <span lang="en-US">(<a href="ExtDB_11.htm#v045p10">v.45
			</a></span><a href="ExtDB_11.htm#v045p10"><span lang="ru-RU">п.10</span></a><span lang="en-US">):</span></p>
			<p lang="en-US">- Конструктор проверяет корректность аргументов
			Kind и NullAsDefaultValue, когда один из аргументов - константа
			NULL.</p>
			<p lang="en-US">- <span lang="ru-RU">Свойство </span>ComparisionToNull</p>
			<p lang="en-US">- TestFilter() обрабатывает сравнение с
			константами DBxConst(null), аналогично SQL-запросам IS NULL/IS NOT
			NULL 
			</p>
			<p><span lang="en-US">- TestFilter() </span><span lang="ru-RU">использует
			</span><span lang="en-US">DataTools.CompareNumbers() (<a href="ExtTools_20.htm#v345p6">ExtTools,
			v.345 </a></span><a href="ExtTools_20.htm#v345p6"><span lang="ru-RU">п.6</span></a><span lang="en-US">)</span></p>
			<p>13. Конструкторы ValueFilter() правильно устанавливают свойство
			NullAsDefaultValue для операций сравнения, отличных от Equal.
			Выделен protected-метод DBxSqlFormatter.GetDefaultValue(). Метод
			переопределяется в SQLite, где минимальной датой считается
			'1000-01-01'</p>
			<p><span lang="ru-RU">14</span><span lang="en-US">.</span>
			<span lang="ru-RU">Изменения в</span> <span lang="en-US">ValuesFilter
			</span><span lang="ru-RU">(</span><a href="ExtDB_11.htm#v001p3"><span lang="en-US">v.1
			</span><span lang="ru-RU">п.3</span></a><span lang="ru-RU">):</span></p>
			<p lang="en-US">- Конструктор проверяет, что массив не содержит
			значений null и DBNull и все значения имеют один тип.</p>
			<p lang="en-US">- <span lang="ru-RU">Свойство </span>NullAsDefaultValue
			(<span lang="ru-RU">только для чтения</span>)</p>
			<p><span lang="en-US">- TestFilter() </span><span lang="ru-RU">использует
			</span><span lang="en-US">DataTools.CompareNumbers() (<a href="ExtTools_20.htm#v345p6">ExtTools,
			v.345 </a></span><a href="ExtTools_20.htm#v345p6"><span lang="ru-RU">п.6</span></a><span lang="en-US">)</span></p>
			<p><span lang="ru-RU">15</span><span lang="en-US">.</span> <span lang="en-US">Метод
			SubstringFilter.TestFilter() </span><span lang="ru-RU">(</span><a href="ExtDB_11.htm#v001p3"><span lang="en-US">v.1
			</span><span lang="ru-RU">п.3</span></a><span lang="ru-RU">)</span>
			<span lang="en-US">был реализован неправильно.</span></p>
			<p><span lang="ru-RU">16</span><span lang="en-US">. </span><span lang="ru-RU">Конструкторы</span>
			<span lang="en-US">DateRangeFilter </span><span lang="ru-RU">и
			</span><span lang="en-US">DateRangeCrossFilter </span><span lang="ru-RU">заменяют
			значения DateTime.MinValue и </span><span lang="en-US">MaxValue.Date
			</span><span lang="ru-RU">на </span><span lang="en-US">null.
			</span><span lang="ru-RU">Конструктор</span> <span lang="ru-RU">с
			аргументом </span><span lang="en-US">DateRange </span><span lang="ru-RU">учитывает
			D</span><span lang="en-US">ateRange.Empty</span><span lang="ru-RU">.
			</span><span lang="en-US">DateRangeCrossFilter.Degeneration
			</span><span lang="ru-RU">возвращает </span><span lang="en-US">AlwaysTrue,
			</span><span lang="ru-RU">если </span><span lang="en-US">FirstDate
			</span><span lang="ru-RU">и </span><span lang="en-US">LastDate=null.</span></p>
			<p><span lang="ru-RU">17</span><span lang="en-US">. </span><span lang="ru-RU">Исправлена
			реализация </span><span lang="en-US">StartsWithFilter.TestFilter()
			(<a href="ExtDB_11.htm#v001p3">v.1 </a></span><a href="ExtDB_11.htm#v001p3"><span lang="ru-RU">п.3</span></a><span lang="en-US">)</span></p>
			<p><span lang="ru-RU">18</span><span lang="en-US">. </span><span lang="ru-RU">В
			методах </span><span lang="en-US">AndFilter, OrFilter.FromArray(),
			FromList() </span><span lang="ru-RU">исправлен поиск &quot;вырожденных&quot;
			фильтров (</span><a href="ExtDB_11.htm#v036p6"><span lang="en-US">v.36
			</span><span lang="ru-RU">п.6</span></a><span lang="ru-RU">)</span><span lang="en-US">.
			</span><span lang="ru-RU">Исправлена реализация оператора &quot;</span><span lang="en-US">|</span><span lang="ru-RU">&quot;</span>
			<span lang="ru-RU">для </span><span lang="en-US">DBxFilter </span><span lang="ru-RU">для
			&quot;вырожденных&quot; фильтров.</span></p>
			<p><span lang="en-US">1</span><span lang="ru-RU">9</span><span lang="en-US">.
			Изменения в BaseDBxSqlFormatter </span><span lang="ru-RU">(</span><a href="ExtDB_11.htm#v001p5"><span lang="en-US">v.1
			</span><span lang="ru-RU">п.5</span></a><span lang="ru-RU">):</span></p>
			<p lang="en-US"><span lang="ru-RU">- </span>OnFormatFilter()
			<span lang="ru-RU">вначале сразу проверяет </span>DBxFilter.Degeneration<span lang="ru-RU">.
			Для вырожденных фильтров вызывается </span>OnFormatDummyFilter().</p>
			<p><span lang="ru-RU">20</span><span lang="en-US">. </span>Изменения
			в <span lang="en-US">BaseDBxSqlFormatter (<a href="ExtDB_11.htm#v045p3">v.45
			</a></span><a href="ExtDB_11.htm#v045p3">п.3</a><span lang="en-US">):</span></p>
			<p>- <span lang="en-US">OnFormatExpression() </span>для <span lang="en-US">DBxConst
			</span>приоритетно использует <span lang="en-US">columnType </span>из
			<span lang="en-US">DBxFormatInfo, </span>а не из <span lang="en-US">DBxConst.</span></p>
			<p><span lang="en-US">- OnFormatStringFilter() </span><span lang="ru-RU">не
			устанавливает для замещающего фильтра свойство
			</span><span lang="en-US">CompareFilter.NullAsDefaultValue.</span></p>
			<p><span lang="ru-RU">21</span><span lang="en-US">.</span>
			<span lang="en-US">Изменения в DataViewDBxSqlFormatter</span> <span lang="ru-RU">(</span><a href="ExtDB_11.htm#v001p5"><span lang="en-US">v.1
			</span><span lang="ru-RU">п.5</span></a><span lang="ru-RU">)</span><span lang="en-US">:</span></p>
			<p><span lang="en-US">-</span> <span lang="en-US">OnFormatColumn()
			использует свойство DBxSqlBuffer.ColumnStructs, как метод
			BaseDBxSqlFormatter.OnFormatColumn().</span></p>
			<p><span lang="en-US">- </span><span lang="ru-RU">Реализован метод
			</span><span lang="en-US">OnFormatFunction() </span><span lang="ru-RU">для
			функции </span><span lang="en-US">DBxFunctionType.Abs </span><span lang="ru-RU">через
			</span><span lang="en-US">IIF().</span> <span lang="ru-RU">Реализована
			функция </span><span lang="en-US">Coalesce </span><span lang="ru-RU">для
			трех и более аргумента, когда требуется использование вложенных
			</span><span lang="en-US">ISNULL(). </span>
			</p>
			<p><span lang="ru-RU">22</span>. Изменения в <span lang="en-US">SQLiteDBxSqlFormatter
			(<a href="ExtDB_11.htm#v029p1">v.29 </a></span><a href="ExtDB_11.htm#v029p1">п.1</a><span lang="en-US">):</span></p>
			<p>- Функция <span lang="en-US">DBxFunctionKind.Length </span>имеет
			имя &quot;<span lang="en-US">LENGTH</span>&quot;<span lang="en-US">,
			</span>а не &quot;<span lang="en-US">LEN</span>&quot;</p>
			<p lang="en-US">- <span lang="ru-RU">Поддержка типа </span>TimeSpan
			<span lang="ru-RU">в </span>OnFormatCompareFilter() (<span lang="ru-RU">только
			для сравнения &quot;=&quot; и &quot;</span>&lt;&gt;<span lang="ru-RU">&quot;</span>)
			<span lang="ru-RU">и </span>OnFormatValuesFilter. <span lang="ru-RU">Используется
			преобразование в строку с помощью
			&quot;</span>CONVERT(<span lang="ru-RU">ИмяПоля,</span>System.String)<span lang="ru-RU">&quot;</span>,
			<span lang="ru-RU">т.к. </span>DataView <span lang="ru-RU">не
			поддерживает операции сравнения для типа </span>TimeSpan</p>
			<p>- Поддержка типа <span lang="en-US">Guid</span> в
			<span lang="en-US">OnFormatValuesFilter</span>() (для
			<span lang="en-US">CompareFilter </span>сравнение работает)</p>
			<p><span lang="ru-RU">23</span><span lang="en-US">. </span><span lang="ru-RU">Изменения
			в NpgsqlDBxSqlFormatter</span> <span lang="en-US">(<a href="ExtDB_11.htm#v009p1">v.9
			</a></span><a href="ExtDB_11.htm#v009p1"><span lang="ru-RU">п.1</span></a><span lang="en-US">)</span><span lang="ru-RU">:</span></p>
			<p lang="en-US"><span lang="ru-RU">- G</span>etFunctionName()
			<span lang="ru-RU">возвращает &quot;</span>LENGTH<span lang="ru-RU">&quot;</span>.</p>
			<p lang="en-US">- <span lang="ru-RU">Исправлен метод
			</span>OnFormatStartsWithFilter()</p>
			<p lang="en-US">- <span lang="ru-RU">Определен метод
			</span>OnFomatOrder(). <span lang="ru-RU">Добавляет </span>NULLS
			FIRST / NULLS LAST</p>
			<p><span lang="ru-RU">24</span><span lang="en-US">.
			SqlDBxCon.DoAddRecords() (<a href="ExtDB_11.htm#v009p5">v.9 </a></span><a href="ExtDB_11.htm#v009p5"><span lang="ru-RU">п.5</span></a><span lang="en-US">)
			</span><span lang="ru-RU">выполняет замену значений </span><span lang="en-US">TimeSpan
			</span><span lang="ru-RU">в таблице данных на </span><span lang="en-US">DateTime,
			</span><span lang="ru-RU">если используется </span><span lang="en-US">MS
			SQL Server 2005.</span></p>
			<p><span lang="en-US">25. </span><span lang="ru-RU">Изменения в
			SqlDBxSqlFormatter (</span><a href="ExtDB_11.htm#v001p11"><span lang="en-US">v.1
			</span><span lang="ru-RU">п.11</span></a><span lang="ru-RU">):</span></p>
			<p><span lang="ru-RU">- </span><span lang="en-US">OnFormatFunction()
			</span><span lang="ru-RU">для функции </span><span lang="en-US">Coalesce
			</span><span lang="ru-RU">в </span><span lang="en-US">MS SQL
			Server 2005</span><span lang="en-US">-2008</span><span lang="en-US">
			</span><span lang="ru-RU">использует вызовы </span><span lang="en-US">ISNULL()
			</span><span lang="ru-RU">с двумя аргументами, как в </span><span lang="en-US">DataView</span><span lang="ru-RU">.</span></p>
			<p lang="en-US"><span lang="ru-RU">- OnFormatAgregateFunction()
			использует </span>AVG(CONVERT(FLOAT, <span lang="ru-RU">выражение))
			для целочисленных столбцов.</span></p>
			<p lang="en-US"><span lang="ru-RU">- </span>GetDefaultValue()
			<span lang="ru-RU">возвращает 01.01.1753 а не 01.01.0001 для
			совместимости с </span>MS SQL Server 2005.</p>
			<p><span lang="ru-RU">26</span><span lang="en-US">. </span><span lang="ru-RU">Изменения
			в </span><span lang="en-US">OleDb</span><span lang="ru-RU">DBxSqlFormatter</span>
			<span lang="en-US">(<a href="ExtDB_11.htm#v016p1">v.16 </a></span><a href="ExtDB_11.htm#v016p1"><span lang="ru-RU">п.1</span></a><span lang="en-US">):</span></p>
			<p><span lang="en-US">- GetFunctionName() </span><span lang="ru-RU">возвращает
			имена &laquo;</span><span lang="en-US">MID</span><span lang="ru-RU">&raquo;</span><span lang="en-US">,
			</span><span lang="ru-RU">&laquo;</span><span lang="en-US">UCASE</span><span lang="ru-RU">&raquo;
			и &laquo;</span><span lang="en-US">LCASE</span><span lang="ru-RU">&raquo;</span></p>
			<p><span lang="en-US">- </span><span lang="ru-RU">Реализация
			фильтров </span><span lang="en-US">StringVallueFilter(),
			SubstringFilter() </span><span lang="ru-RU">и </span><span lang="en-US">StartsWithFilter()
			</span><span lang="ru-RU">с помощью функций </span><span lang="en-US">STRCOMP()
			</span><span lang="ru-RU">и </span><span lang="en-US">MID().</span></p>
			<p><span lang="en-US">27. Ч</span><span lang="ru-RU">ерновая
			поддержка временных таблиц в </span><span lang="en-US">MS SQL
			Server (<a href="ExtDB_11.htm#v001p11">v.1 </a></span><a href="ExtDB_11.htm#v001p11"><span lang="ru-RU">п.11</span></a><span lang="en-US">).
			</span><span lang="ru-RU">Метод
			</span><span lang="en-US">SqlDBxCon.CreateTempTableInternal().
			</span><span lang="ru-RU">Переопределен метод
			</span><span lang="en-US">SqlDBx.IsValidTableName() </span><span lang="ru-RU">для
			разрешения таблиц, начинающихся с &quot;</span><span lang="en-US">#</span><span lang="ru-RU">&quot;</span><span lang="en-US">.
			</span><span lang="ru-RU">Виртуальный метод
			</span><span lang="en-US">DBxConBase.GetTableStruct(),
			</span><span lang="ru-RU">переопределен в </span><span lang="en-US">SqlDBxCon.</span></p>
			<p><span lang="en-US">28</span><span lang="ru-RU">. Конструктор
			</span><span lang="en-US">DBxNameValidator (<a href="ExtDB_11.htm#v045p9">v.45
			</a></span><a href="ExtDB_11.htm#v045p9"><span lang="ru-RU">п.9</span></a><span lang="en-US">)
			</span><span lang="ru-RU">изменен и сделан </span><span lang="en-US">internal.</span></p>
			<p><span lang="en-US">29. </span><span lang="ru-RU">Свойство
			</span><span lang="en-US">DBxNamedExpression</span><span lang="ru-RU">.</span><span lang="en-US">Alias
			(<a href="ExtDB_11.htm#v045p6">v.45 </a></span><a href="ExtDB_11.htm#v045p6"><span lang="ru-RU">п.6</span></a><span lang="en-US">)
			</span><span lang="ru-RU">теперь может быть пустой строкой, если
			альяс не задан в прикладном коде в явном виде. Убрано свойство
			</span><span lang="en-US">AliasRequires. </span><span lang="ru-RU">Новое
			свойство </span><span lang="en-US">ResultColumnName, </span><span lang="ru-RU">которое
			используется как </span><span lang="en-US">IObjectWithCode.Code
			</span><span lang="ru-RU">при создании списка выражений.</span></p>
			<p><span lang="en-US">30. </span><span lang="ru-RU">Метод
			</span><span lang="en-US">DBxSelectInfo</span><span lang="ru-RU">.</span><span lang="en-US">Clone()
			(<a href="ExtDB_11.htm#v051p5">v.51 </a></span><a href="ExtDB_11.htm#v051p5"><span lang="ru-RU">п.5</span></a><span lang="en-US">)</span></p>
			<p><span lang="en-US">31. DBxSelectFormatter </span><span lang="ru-RU">(</span><a href="ExtDB_11.htm#v051p6"><span lang="en-US">v.51
			</span><span lang="ru-RU">п.6</span></a><span lang="ru-RU">) не
			добавляет инструкцию </span><span lang="en-US">AS, </span><span lang="ru-RU">если
			альяс для выражения не задан в явном виде.</span></p>
		</td>
	</tr>
	<tr valign="top">
		<td width="10%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: 1.00pt solid #000000; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0.05cm; padding-right: 0.05cm" sdval="339" sdnum="1049;">
			<p lang="en-US" align="center">339</p>
		</td>
		<td width="14%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: none; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0cm; padding-right: 0.05cm">
			<p lang="en-US" align="center">07.02.2023</p>
		</td>
		<td width="77%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: none; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0cm; padding-right: 0.05cm">
			<p><span lang="en-US">1. DBxCache.DoLoadCachePage() </span><span lang="ru-RU">выпускает
			наружу исключение </span><span lang="en-US">UserCancelException,
			</span><span lang="ru-RU">вместо того, чтобы выполнять оставшиеся
			попытки (</span><a href="ExtDB_11.htm#v014p1"><span lang="en-US">v.14
			</span><span lang="ru-RU">п.1</span></a><span lang="ru-RU">).</span></p>
		</td>
	</tr>
	<tr valign="top">
		<td width="10%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: 1.00pt solid #000000; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0.05cm; padding-right: 0.05cm" sdval="325" sdnum="1049;">
			<p lang="en-US" align="center">325</p>
		</td>
		<td width="14%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: none; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0cm; padding-right: 0.05cm">
			<p lang="en-US" align="center">18.08.2022</p>
		</td>
		<td width="77%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: none; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0cm; padding-right: 0.05cm">
			<p lang="en-US">1. <span lang="ru-RU">Свойство </span>DBx.UseTrimEnd
			(<span lang="ru-RU">возвращает </span>true <span lang="ru-RU">для
			всех баз данных, кроме </span>SQLiteDBx<span lang="ru-RU">).</span>
			<span lang="ru-RU">Метод </span>DBxConBase.SQLExecuteDataTable()
			<span lang="ru-RU">вызывает </span>DataTools.TrimEnd() <span lang="ru-RU">для
			удаления лишних пробелов в строковых полях.</span> <span lang="ru-RU">Выделен
			защищенный метод </span>DBxConBase.PrepareReturnedValue() <span lang="ru-RU">для
			обработки одиночных значений</span></p>
		</td>
	</tr>
	<tr valign="top">
		<td width="10%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: 1.00pt solid #000000; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0.05cm; padding-right: 0.05cm" sdval="315" sdnum="1049;">
			<p align="center">315</p>
		</td>
		<td width="14%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: none; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0cm; padding-right: 0.05cm">
			<p align="center">19.04.2022</p>
		</td>
		<td width="77%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: none; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0cm; padding-right: 0.05cm">
			<p><span lang="en-US">1. </span><span lang="ru-RU">Метод
			</span><span lang="en-US">DBxTableStructList.GetRequired() (<a href="ExtTools_11.htm#v181p2">v.181
			</a></span><a href="ExtTools_11.htm#v181p2"><span lang="ru-RU">п.2</span></a><span lang="en-US">)
			</span><span lang="ru-RU">выбрасывают исключение
			</span><span lang="en-US">KeyNotFoundExeption, </span><span lang="ru-RU">а
			не </span><span lang="en-US">ArgumentException.</span></p>
		</td>
	</tr>
	<tr valign="top">
		<td width="10%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: 1.00pt solid #000000; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0.05cm; padding-right: 0.05cm" sdval="314" sdnum="1049;">
			<p align="center">314</p>
		</td>
		<td width="14%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: none; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0cm; padding-right: 0.05cm">
			<p align="center">12.04.2022</p>
		</td>
		<td width="77%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: none; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0cm; padding-right: 0.05cm">
			<p>1. <span lang="ru-RU">Уточнена регистрочувствительность для
			строковых фильтров </span><span lang="en-US">StringValueFilter</span>
			<span lang="ru-RU">(</span><a href="ExtDB_11.htm#v020p2"><span lang="en-US">v.20
			</span><span lang="ru-RU">п.2</span></a><span lang="ru-RU">)</span><span lang="en-US">,
			SubstringFilter (<a href="ExtDB_11.htm#v038p5">v.38 </a></span><a href="ExtDB_11.htm#v038p5"><span lang="ru-RU">п.5</span></a><span lang="en-US">)
			</span><span lang="ru-RU">и StartsWithFilter (</span><a href="ExtDB_11.htm#v020p1"><span lang="en-US">v.20
			</span><span lang="ru-RU">п.1</span></a><span lang="ru-RU">)</span></p>
			<p><span lang="ru-RU">- Защищенный статический метод
			BaseDBxSqlFormatter.StringIsCaseSensitive() (</span><a href="ExtDB_11.htm#v045p3"><span lang="en-US">v.45
			</span><span lang="ru-RU">п.3</span></a><span lang="ru-RU">). </span>
			</p>
			<p><span lang="en-US">- </span><span lang="ru-RU">В методах
			обобщенной реализации
			BaseDBxSqlFormatter.</span><span lang="en-US">OnFormatStringValueFilter(),
			OnFormatSubstringFilter() </span><span lang="ru-RU">и
			</span><span lang="en-US">OnFormatStartsWithFiter()</span><span lang="ru-RU">,
			если </span><span lang="en-US">Value </span><span lang="ru-RU">не
			содержит букв, не выполняется вызов</span> <span lang="en-US">UPPER()</span></p>
			<p>- В <span lang="en-US">SqlDBxFormatter </span>(<a href="ExtDB_11.htm#v001p11"><span lang="en-US">v.1
			</span>п.11</a>) для этих фильтров добавляется оператор <span lang="en-US">COLLATE,
			</span>чтобы обеспечить правильное сравнение</p>
			<p><span lang="en-US">-
			NpgsqlDBxSqlFormatter.OnFormatStartsWithFilter() </span><span lang="ru-RU">(</span><a href="ExtDB_11.htm#v009p1"><span lang="en-US">v.9
			</span><span lang="ru-RU">п.1</span></a><span lang="ru-RU">)
			использует нестандартный оператор </span><span lang="en-US">ILIKE
			</span><span lang="ru-RU">в </span><span lang="en-US">PostgreSQL.
			</span><span lang="ru-RU">Для других фильтров используется
			обобщенная реализация.</span></p>
			<p><span lang="ru-RU">- При создании первого объекта </span><span lang="en-US">SQLiteDBx
			(<a href="ExtDB_11.htm#v029p1">v.29 </a></span><a href="ExtDB_11.htm#v029p1"><span lang="ru-RU">п.1</span></a><span lang="en-US">)
			</span><span lang="ru-RU">устанавливаются пользовательские
			реализации функций </span><span lang="en-US">UPPER() </span><span lang="ru-RU">и
			</span><span lang="en-US">LOWER()</span> <span lang="ru-RU">взамен
			ограниченной стандартной реализации</span><span lang="en-US">. </span><span lang="ru-RU">Они
			вызывают методы </span><span lang="en-US">String.ToUpperInvariant()
			</span><span lang="ru-RU">и </span><span lang="en-US">ToLowerInvariant()</span><span lang="ru-RU">.
			Управляющее статическое свойство UseInvariantStringFunctions.</span></p>
			<p>- <span lang="en-US">SQLiteDBxFormatter.OnFormatStartsWithFilter()
			</span>заменяет фильтр на <span lang="en-US">SubstringFilter,
			</span>чтобы отказаться от использования ненадежного оператора
			<span lang="en-US">LIKE.</span></p>
			<p><span lang="ru-RU">2. Метод
			</span><span lang="en-US">SQLiteDBxFormatter.GetFunctionName()
			(<a href="ExtDB_11.htm#v045p1">v.45 </a></span><a href="ExtDB_11.htm#v045p1"><span lang="ru-RU">п.1</span></a><span lang="en-US">)
			</span><span lang="ru-RU">возвращает</span> <span lang="ru-RU">имя
			функции &quot;</span><span lang="en-US">SUBSTR</span><span lang="ru-RU">&quot;,
			а не &quot;</span><span lang="en-US">SUBSTRING</span><span lang="ru-RU">&quot;
			как в других БД.</span></p>
		</td>
	</tr>
	<tr valign="top">
		<td width="10%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: 1.00pt solid #000000; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0.05cm; padding-right: 0.05cm" sdval="311" sdnum="1049;">
			<p lang="en-US" align="center">311</p>
		</td>
		<td width="14%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: none; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0cm; padding-right: 0.05cm">
			<p lang="en-US" align="center">17.02.2022-23.02.2022</p>
		</td>
		<td width="77%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: none; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0cm; padding-right: 0.05cm">
			<p><span lang="en-US">1. </span><span lang="ru-RU">Метод
			</span><span lang="en-US">DBxPermissions.Clone() (<a href="ExtDB_11.htm#v001p8">v.1
			</a></span><a href="ExtDB_11.htm#v001p8"><span lang="ru-RU">п.8</span></a><span lang="en-US">)</span></p>
			<p><span lang="en-US">2. </span><span lang="ru-RU">Метод
			</span><span lang="en-US">DBxTableCache.GetTreeChainIds()</span></p>
		</td>
	</tr>
	<tr valign="top">
		<td width="10%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: 1.00pt solid #000000; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0.05cm; padding-right: 0.05cm" sdval="309" sdnum="1049;">
			<p lang="en-US" align="center">309</p>
		</td>
		<td width="14%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: none; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0cm; padding-right: 0.05cm">
			<p lang="en-US" align="center">02.02.2022</p>
		</td>
		<td width="77%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: none; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0cm; padding-right: 0.05cm">
			<p><span lang="en-US">1. </span><span lang="ru-RU">Конструкторы
			</span><span lang="en-US">SQLiteDBx, </span><span lang="ru-RU">принимающие
			путь к файлу (</span><a href="ExtDB_11.htm#v029p1"><span lang="en-US">v.29
			</span><span lang="ru-RU">п.1</span></a><span lang="ru-RU">) и для
			создания временной базы данных</span> <span lang="en-US">(<a href="ExtDB_11.htm#v077p3">v.77
			</a></span><a href="ExtDB_11.htm#v077p3"><span lang="ru-RU">п.3</span></a><span lang="en-US">)</span><span lang="ru-RU">,
			устанавливают в строке подключения значение &quot;</span><span lang="en-US">foreign
			keys=true</span><span lang="ru-RU">&quot;, чтобы обеспечивалась
			ссылочная целостность.</span></p>
		</td>
	</tr>
	<tr valign="top">
		<td width="10%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: 1.00pt solid #000000; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0.05cm; padding-right: 0.05cm" sdval="308" sdnum="1049;">
			<p lang="en-US" align="center">308</p>
		</td>
		<td width="14%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: none; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0cm; padding-right: 0.05cm" sdval="44567" sdnum="1049;0;@">
			<p lang="en-US" align="center">06.01.2022-19.01.2022</p>
		</td>
		<td width="77%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: none; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0cm; padding-right: 0.05cm">
			<p><span lang="en-US">1. </span><span lang="ru-RU">В методе
			</span><span lang="en-US">SQLiteDBxCon.DoSplitValueType() </span><span lang="ru-RU">(</span><a href="ExtDB_11.htm#v059p2"><span lang="en-US">v.59
			</span><span lang="ru-RU">п.2</span></a><span lang="ru-RU">) не
			проверялась запятая в формате вида &laquo;</span><span lang="en-US">NUMERIC(18,2)</span><span lang="ru-RU">&raquo;
			и возникало исключение. Это приводило к лишнему обновлению
			структуры таблицы.</span></p>
			<p><span lang="en-US">2. </span><span lang="ru-RU">Перегрузка
			DBxNamedExpressionList</span><span lang="en-US">.Add(),
			</span><span lang="ru-RU">принимающая одну текстовую строку (</span><a href="ExtDB_11.htm#v045p6"><span lang="en-US">v.45
			</span><span lang="ru-RU">п.6</span></a><span lang="ru-RU">),
			разрешает задавать несколько имен полей через запятую. Новая
			перегрузка с двумя аргументами, принимающая имя поля и альяс.</span></p>
		</td>
	</tr>
	<tr valign="top">
		<td width="10%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: 1.00pt solid #000000; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0.05cm; padding-right: 0.05cm">
			<p lang="en-US" align="center">301</p>
		</td>
		<td width="14%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: none; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0cm; padding-right: 0.05cm">
			<p lang="en-US" align="center">21.10.2021-22.11.2021</p>
		</td>
		<td width="77%" style="border-top: none; border-bottom: 1.00pt solid #000000; border-left: none; border-right: 1.00pt solid #000000; padding-top: 0cm; padding-bottom: 0.05cm; padding-left: 0cm; padding-right: 0.05cm">
			<p lang="en-US">1. <span lang="ru-RU">Изменения пространств имен</span></p>
			<p><span lang="en-US">2. </span><span lang="ru-RU">Свойство
			</span><span lang="en-US">DBxTableStruct.Indices </span><span lang="ru-RU">(</span><a href="ExtDB_11.htm#v001p9"><span lang="en-US">v.1
			</span><span lang="ru-RU">п.9</span></a><span lang="ru-RU">)
			переименовано в </span><span lang="en-US">Indexes.</span></p>
		</td>
	</tr>
</table>
<p><span lang="en-US">См. также <a href="ExtDB_11.htm">версию 1.1</a>
и описание <a href="Changes11_20.htm">перехода на версию 2.0</a></span></p>
</body>
</html>