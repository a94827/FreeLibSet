<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=windows-1251"/>
	<title></title>
	<meta name="generator" content="LibreOffice 5.4.7.2 (Windows)"/>
	<meta name="created" content="2022-01-28T14:13:32.885000000"/>
	<meta name="changed" content="2022-01-31T12:39:52.205000000"/>
	<style type="text/css">
		@page { margin: 2cm }
		p { margin-bottom: 0.25cm; line-height: 120% }
		td p { margin-bottom: 0.25cm; line-height: 120% }
		h2.western { font-family: "Albany", sans-serif; font-size: 16pt }
		h2.cjk { font-family: "SimSun"; font-size: 16pt }
		h2.ctl { font-family: "Mangal"; font-size: 16pt }
	</style>
</head>
<body lang="ru-RU" dir="ltr">
<p align="left" style="margin-top: 0.42cm; margin-bottom: 0.21cm; line-height: 100%; page-break-after: avoid">
<font face="Liberation Sans, sans-serif"><font size="6" style="font-size: 28pt"><b>DBxDocPermissions</b></font></font></p>
<p style="margin-bottom: 0cm; line-height: 100%">Проверка разрешений
при выполнении действий с документами<span lang="en-US">.</span></p>
<p style="margin-bottom: 0cm; line-height: 100%">Выполняется
классами, производными от <span lang="en-US">UserPermission, </span>которые
реализуют интерфейс IDBxDocPermission. Коллекция объектов
<span lang="en-US">UserPermissions </span>является сериализуемой,
поэтому проверка может выполняться как на стороне сервера, так и на
стороне клиента.</p>
<p style="margin-bottom: 0cm; line-height: 100%"><br/>

</p>
<p style="margin-bottom: 0cm; line-height: 100%">Вызовы метода
IDBxDocPermission<span lang="en-US">.TestDocAllowed() </span><span lang="ru-RU">при
выполнении различных действий с документами</span></p>
<table width="100%" cellpadding="5" cellspacing="0">
	<col width="109*">
	<col width="33*">
	<col width="114*">
	<tr valign="top">
		<td width="43%" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p align="center">Действие</p>
		</td>
		<td width="13%" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p align="center">DBxDocPermissionReason</p>
		</td>
		<td width="45%" style="border: 1px solid #000000; padding: 0.1cm">
			<p align="center">Примечания</p>
		</td>
	</tr>
	<tr valign="top">
		<td width="43%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">DBxMultiDocs.View(id)</p>
			<p lang="en-US">(<span lang="ru-RU">открытие на просмотр по
			идентификатору</span>)</p>
		</td>
		<td width="13%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">View</p>
		</td>
		<td width="45%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
			<p><br/>

			</p>
		</td>
	</tr>
	<tr valign="top">
		<td width="43%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">DBxSingleDoc.View()</p>
			<p>(перевод редактируемого документа в состояние просмотра)</p>
		</td>
		<td width="13%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p align="center">-</p>
		</td>
		<td width="45%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
			<p><br/>

			</p>
		</td>
	</tr>
	<tr valign="top">
		<td rowspan="3" width="43%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">DBxMultiDocs.Edit(id) 
			</p>
			<p lang="en-US">(<span lang="ru-RU">открытие на редактирование по
			идентификатору</span> - <span lang="ru-RU">обычный документ</span>)</p>
		</td>
		<td width="13%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US"><span lang="ru-RU">1. </span>View</p>
		</td>
		<td width="45%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
			<p><br/>

			</p>
		</td>
	</tr>
	<tr valign="top">
		<td width="13%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p>2. <span lang="en-US">BeforeRestore</span></p>
		</td>
		<td width="45%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
			<p>Если документ в базе данных был помечен на удаление</p>
		</td>
	</tr>
	<tr valign="top">
		<td width="13%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US"><span lang="ru-RU">3. </span>BeforeEdit</p>
		</td>
		<td width="45%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
			<p><br/>

			</p>
		</td>
	</tr>
	<tr valign="top">
		<td rowspan="2" width="43%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">DBxSingleDoc.Edit()</p>
			<p>(открытие на редактирование из режима просмотра)</p>
		</td>
		<td width="13%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">1. BeforeRestore</p>
		</td>
		<td width="45%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
			<p>Если просматриваемый документ на момент выполнения <span lang="en-US">View()
			</span><span lang="ru-RU">был помечен на удаление</span></p>
		</td>
	</tr>
	<tr valign="top">
		<td width="13%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">2. BeforeEdit</p>
		</td>
		<td width="45%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
			<p><br/>

			</p>
		</td>
	</tr>
	<tr valign="top">
		<td width="43%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">DBxMultiDocs.Insert()</p>
		</td>
		<td width="13%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US" align="center">-</p>
		</td>
		<td width="45%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
			<p><br/>

			</p>
		</td>
	</tr>
	<tr valign="top">
		<td width="43%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">DBxMultiDocs.InsertCopy(id)</p>
			<p lang="en-US">(<span lang="ru-RU">создание нового документа на
			основании другого по идентификатору</span>)</p>
		</td>
		<td width="13%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">View</p>
		</td>
		<td width="45%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
			<p><br/>

			</p>
		</td>
	</tr>
	<tr valign="top">
		<td width="43%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">DBxMultiDocs.InsertCopy()</p>
			<p lang="en-US">(<span lang="ru-RU">создание нового документа на
			основании открытого на просмотре</span>)</p>
		</td>
		<td width="13%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p align="center">-</p>
		</td>
		<td width="45%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
			<p><br/>

			</p>
		</td>
	</tr>
	<tr valign="top">
		<td rowspan="2" width="43%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">DBxMultiDocs.Delete(id)</p>
			<p lang="en-US">(<span lang="ru-RU">удаление по идентификатору</span>)</p>
		</td>
		<td width="13%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p>1. <span lang="en-US">View</span></p>
		</td>
		<td width="45%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
			<p><br/>

			</p>
		</td>
	</tr>
	<tr valign="top">
		<td width="13%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">2. BeforeDelete</p>
		</td>
		<td width="45%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
			<p><br/>

			</p>
		</td>
	</tr>
	<tr valign="top">
		<td width="43%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">DBxSingleDoc.Delete()</p>
			<p lang="en-US">(<span lang="ru-RU">удаление документа, открытого
			на просмотр или редактирование</span>)</p>
		</td>
		<td width="13%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">BeforeDelete</p>
		</td>
		<td width="45%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
			<p><br/>

			</p>
		</td>
	</tr>
	<tr valign="top">
		<td width="43%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">DBxMultiDocs.Delete()</p>
			<p lang="en-US">(<span lang="ru-RU">удаление всех документов,
			открытых на просмотр</span>)</p>
		</td>
		<td width="13%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">BeforeDelete</p>
		</td>
		<td width="45%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
			<p><br/>

			</p>
		</td>
	</tr>
	<tr valign="top">
		<td width="43%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">DBxMultiDocs.ViewVersion(id)</p>
		</td>
		<td width="13%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">View</p>
		</td>
		<td width="45%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
			<p><br/>

			</p>
		</td>
	</tr>
	<tr valign="top">
		<td rowspan="2" width="43%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">DBxDocProvider.GetDocHistTable()</p>
		</td>
		<td width="13%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">1. View</p>
		</td>
		<td width="45%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
			<p><span lang="en-US">DBxDocPermissionArgs.Values </span>содержит
			значения актуальной версии документа в базе данных</p>
		</td>
	</tr>
	<tr valign="top">
		<td width="13%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">2. ViewHistory</p>
		</td>
		<td width="45%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
			<p><span lang="en-US">DBxDocPermissionArgs.Values </span>содержит
			значения актуальной версии документа в базе данных</p>
		</td>
	</tr>
	<tr valign="top">
		<td width="43%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">DBxDocSet.ApplyChanges()</p>
			<p>Зависит от состояния <span lang="en-US">DocState </span>конкретного
			документа</p>
		</td>
		<td width="13%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p><br/>

			</p>
		</td>
		<td width="45%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
			<p><br/>

			</p>
		</td>
	</tr>
	<tr valign="top">
		<td width="43%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US" style="margin-left: 2cm">View</p>
		</td>
		<td width="13%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US" align="center">-</p>
		</td>
		<td width="45%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
			<p><br/>

			</p>
		</td>
	</tr>
	<tr valign="top">
		<td rowspan="3" width="43%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US" style="margin-left: 2cm">Edit</p>
		</td>
		<td width="13%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">1. ApplyRestore</p>
		</td>
		<td width="45%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
			<p>Если документ в БД помечен на удаление.</p>
			<p>DBxDocPermissionArgs.<span lang="en-US">Values </span><span lang="ru-RU">содержит
			значения, которые будут записаны</span></p>
		</td>
	</tr>
	<tr valign="top">
		<td width="13%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p>2. ApplyEditOrg</p>
		</td>
		<td width="45%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
			<p lang="en-US"><span lang="ru-RU">Проверяются поля документа,
			которые записаны в БД на момент вызова </span>ApplyChanges()<span lang="ru-RU">.
			DBxDocPermissionArgs.</span>Values <span lang="ru-RU">содержит
			текущие значения из базы данных</span></p>
		</td>
	</tr>
	<tr valign="top">
		<td width="13%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">3.<span lang="ru-RU">ApplyEdit</span>New</p>
		</td>
		<td width="45%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
			<p lang="en-US">DBxDocPermissionArgs.Values <span lang="ru-RU">содержит
			значения, которые будут записаны</span></p>
		</td>
	</tr>
	<tr valign="top">
		<td width="43%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US" style="margin-left: 2cm">Insert (<span lang="ru-RU">только
			при первом сохранении документа</span>; <span lang="ru-RU">при
			повторных вызовах </span>ApplyChanges() <span lang="ru-RU">используется
			режим </span>Edit)</p>
		</td>
		<td width="13%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">ApplyNew</p>
		</td>
		<td width="45%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
			<p lang="en-US">DBxDocPermissionArgs.Values <span lang="ru-RU">содержит
			значения, которые будут записаны</span></p>
		</td>
	</tr>
	<tr valign="top">
		<td width="43%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US" style="margin-left: 2cm">Delete</p>
		</td>
		<td width="13%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
			<p lang="en-US">ApplyDelete</p>
		</td>
		<td width="45%" style="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
			<p lang="en-US"><span lang="ru-RU">Проверяются поля документа,
			которые записаны в БД на момент вызова </span>ApplyChanges()<span lang="ru-RU">.
			DBxDocPermissionArgs.</span>Values <span lang="ru-RU">содержит
			текущие значения из базы данных</span></p>
		</td>
	</tr>
</table>
<h2 class="western">Безопасность</h2>
<p style="margin-bottom: 0cm; line-height: 100%">1. Проверки
&quot;<span lang="en-US">ApplyXXX</span>&quot; выполняются при вызове
<span lang="en-US">ApplyChanges</span>() всегда на стороне сервера,
чтобы исключить уязвимость в случае подделки программы клиента. Для
проверок &quot;<span lang="en-US">ApplyEditOrg</span><span lang="ru-RU">&quot;</span><span lang="en-US">
</span>и &quot;<span lang="en-US">ApplyDelete</span><span lang="ru-RU">&quot;</span><span lang="en-US">
</span>выполняется повторное считывание значений полей из базы
данных, так как они могли измениться с начала редактирования (или
подделаны клиентом).</p>
<p style="margin-bottom: 0cm; line-height: 100%"><br/>

</p>
<p style="margin-bottom: 0cm; line-height: 100%">2. Проверки &quot;<span lang="en-US">View</span><span lang="ru-RU">&quot;</span><span lang="en-US">
</span>и &quot;<span lang="en-US">BeforeXXX</span><span lang="ru-RU">&quot;</span><span lang="en-US">
</span>выполняются на стороне клиента<span lang="en-US">. </span>Проверка
&quot;<span lang="en-US">View</span><span lang="ru-RU">&quot;</span><span lang="en-US">,
</span>в общем-то, является формальной, т.к. клиент уже выполнил
загрузку таблицы документов на просмотр. Проверки &quot;<span lang="en-US">BeforeXXX</span><span lang="ru-RU">&quot;</span><span lang="en-US">
</span>нужны для дружественного пользовательского интерфейса, чтобы
не дать пользователю внести изменения, которые все равно не будут
приняты сервером.</p>
<p style="margin-bottom: 0cm; line-height: 100%"><br/>

</p>
<p style="margin-bottom: 0cm; line-height: 100%">3. Проверка
&quot;<span lang="en-US">GetDocHistTable</span><span lang="ru-RU">&quot;</span>
<span lang="ru-RU">выполняется на стороне сервера.</span></p>
<h2 class="western">Блокировки</h2>
<p>На время выполнения метода<span lang="en-US">
DBxRealDocProvider.ApplyChanges() </span><span lang="ru-RU">устанавливается
кратковременная блокировка изменяемых и удаляемых документов. 
Загрузка значений для проверок </span><span lang="en-US">ApplyEditOrg
</span><span lang="ru-RU">и </span><span lang="en-US">ApplyDelete
</span><span lang="ru-RU">выполняется в пределах этой блокировки.</span></p>
<p><span lang="ru-RU">Длительные блокировки могут сделать невозможным
вызов </span><span lang="en-US">DBxRealDocProvider.ApplyChanges()</span><span lang="ru-RU">,
если не удастся установить кратковременную блокировку. Наличие или
отсутствие установленной длительной блокировки не влияет на проверки
</span><span lang="en-US">ApplyEditOrg </span><span lang="ru-RU">и
</span><span lang="en-US">ApplyDelete</span><span lang="ru-RU">.
Можно было бы обойтись без перечитывания значений из базы данных при
наличии длительной блокировки, но тогда осталась бы уязвимость в
случае подделки клиента.</span></p>
<h2 class="western"><span lang="ru-RU">Повторный вызов </span><span lang="en-US">ApplyChanges()</span></h2>
<p>Пользователь может несколько раз нажимать кнопку &quot;Запись&quot;
в редакторе документа. Соответственно, метод <span lang="en-US">ApplyChanges()
</span>вызывается многократно.</p>
<p>- Если был создан новый документ, то повторные вызовы
<span lang="en-US">ApplyChanges() </span>обрабатываются, как если бы
документ редактировался. То есть, вместо проверки &quot;<span lang="en-US">ApplyNew</span>&quot;
выполняются &quot;ApplyRestore&quot; (если вдруг кто-то успел удалить
документ), &quot;ApplyEditOrg&quot; и &quot;ApplyEditNew&quot;.</p>
<p>- Если документ был удален, то он убирается из <span lang="en-US">DBxDocSet
</span>и, следовательно, не будет участвовать в повторном вызове
<span lang="en-US">ApplyChanges().</span></p>
<p>С точки зрения выполнения проверок,
<span lang="en-US">DBxRealDocProvider.ApplyChanges() </span>работает
одинаково и при первом и при повторных вызовах. В частности, каждый
раз выполняется считывание значений из базы данных.</p>
<h2 class="western">Обработчики <span lang="en-US">DBxDocType</span></h2>
<p>На стороне сервера могут задаваться обработчики событий
<span lang="en-US">DBxDocType.BeforeInsert, BeforeWrite, AfterWrite </span>и
<span lang="en-US">BeforeDelete. </span>События <span lang="en-US">BeforeXXX
</span>вызываются в пределах установленной кратковременной
блокировки.</p>
<p>Порядок выполнения действий. Сначала выполняются проверки
<span lang="en-US">TestDocument(), </span>а затем вызываются
обработчики события.</p>
<p>Создание документа при первом вызове <span lang="en-US">ApplyChanges()</span></p>
<p><span lang="en-US">1</span><span lang="en-US">. </span>Проверка
<span lang="en-US">'ApplyNew'</span></p>
<p><span lang="en-US">2</span><span lang="en-US">. </span>Событие
<span lang="en-US">DBxDocType.BeforeInsert</span></p>
<p>3. Событие <span lang="en-US">DBxDocType.BeforeWrite</span></p>
<p><br/>
<br/>

</p>
<p>Изменение документа или повторный вызов <span lang="en-US">ApplyChanges()</span>
для созданного документами</p>
<p>1. Загрузка актуальных значений из базы данных (включая признак
<span lang="en-US">Deleted)</span></p>
<p>2. Проверка <span lang="en-US">'ApplyRestore', </span>если
документ восстанавливается из удаленных</p>
<p>3. Проверка <span lang="en-US">'ApplyEditOrg'</span></p>
<p lang="en-US"><span lang="ru-RU">4</span>. <span lang="ru-RU">Проверка</span>
'ApplyEditNew'.</p>
<p><span lang="en-US">5</span><span lang="en-US">. </span>Событие
<span lang="en-US">DBxDocType.BeforeInsert, </span>если документ
восстанавливается из удаленных</p>
<p lang="en-US"><span lang="ru-RU">6</span>. <span lang="ru-RU">Событие
</span>DBxDocType.BeforeWrite.</p>
<p lang="en-US"><br/>
<br/>

</p>
<p>Удаление документа</p>
<p>1. Загрузка актуальных значений из базы данных</p>
<p>2. Проверка <span lang="en-US">'ApplyDelete'</span></p>
<p><span lang="en-US">3. </span>Событие <span lang="en-US">BeforeDelete</span></p>
</body>
</html>